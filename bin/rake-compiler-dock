#!/usr/bin/env ruby

require 'rake_compiler_dock'

args = ARGV.empty? ? ['bash'] : ARGV.dup

if $stdin.tty?
  # start interactive session
  args << {sigfw: false, options: ['--rm', '-it']}
end

begin
  RakeCompilerDock.exec(*args) do |ok, res|
    exit(res.exitstatus)
  end
rescue RakeCompilerDock::DockerIsNotAvailable
  exit(-1)
end
